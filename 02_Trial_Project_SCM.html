<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SCM Data Hub - Project Budget</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Inter:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --primary-color: #6a6de3;
            --secondary-color: #764ba2;
            --accent-color: #34d399;
            --bg-color: #f4f7fe;
            --text-color: #4a5568;
            --heading-color: #2d3748;
            --card-bg: rgba(255, 255, 255, 0.9);
            --card-border: rgba(255, 255, 255, 0.95);
            --shadow-color: rgba(102, 126, 234, 0.25);
            --free-tier-color: #10b981;
            --danger-color: #ef4444;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.7;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><g fill="%23e0e7ff" fill-opacity="0.4"><circle cx="50" cy="50" r="4"/></g></svg>');
            height: 100vh;
            overflow: hidden;
        }

        /* --- NAVIGATION BAR --- */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: var(--primary-gradient); /* Use the main theme gradient */
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2); /* A slightly stronger shadow for depth */
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 5%;
            height: 70px;
            z-index: 1000;
            border-bottom: none; /* No longer needed with the solid background */
        }
        .navbar .nav-logo,
        .navbar .nav-links a {
            color: white;
            -webkit-text-fill-color: white; /* This overrides the gradient color on your logo */
        }
        .nav-logo { font-family: 'Poppins', sans-serif; font-size: 1.5rem; font-weight: 600; background: var(--primary-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-decoration: none; }
        .nav-links { list-style: none; display: flex; gap: 40px; }
        
        .nav-links a {
            text-decoration: none;
            color: white;
            font-weight: 500;
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            position: relative;
            padding: 8px 18px; /* Add padding to create space for the pill */
            border-radius: 20px; /* Rounded corners for the pill */
            transition: background-color 0.3s ease;
        }
        .nav-links a:hover,
        .nav-links a.active {
            background-color: rgba(255, 255, 255, 0.2); /* Semi-transparent white background */
        }
        .nav-links a::after {
            display: none;
        }
        .nav-links a.disabled { color: #b0b0b0; pointer-events: none; }

        /* --- SLIDE SYSTEM --- */
        .slides-container { position: relative; width: 100%; height: calc(100vh - 70px); margin-top: 70px; perspective: 1000px; }
        .slide { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; padding: 40px; opacity: 0; transform: scale(0.98); transition: opacity 0.4s ease-in-out, transform 0.4s ease-in-out; visibility: hidden; }
        .slide.active { opacity: 1; transform: scale(1); visibility: visible; z-index: 1; }
        .slide-content-card { max-width: 1200px; width: 100%; background: var(--card-bg); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 1px solid var(--card-border); border-radius: 20px; box-shadow: 0 15px 50px var(--shadow-color); overflow: auto; max-height: calc(100vh - 150px); padding: 40px 50px; }
        .slide-indicator { position: fixed; bottom: 20px; right: 30px; background: var(--heading-color); color: white; padding: 8px 15px; border-radius: 20px; font-family: 'Poppins', sans-serif; font-size: 0.9rem; z-index: 1001; }
        
        /* --- STYLES --- */
        .section-title { font-family: 'Poppins', sans-serif; font-size: 2.2rem; font-weight: 600; color: var(--heading-color); margin-bottom: 30px; text-align: center; }
        .cost-table { width: 100%; border-collapse: collapse; font-size: 0.95rem; margin-top: 20px; }
        .cost-table th, .cost-table td { padding: 15px; text-align: left; border-bottom: 1px solid #e2e8f0; }
        .cost-table thead { background-color: rgba(244,247,254, 0.9); }
        .cost-table th { font-family: 'Poppins', sans-serif; color: var(--secondary-color); }
        .cost-table .cost { font-weight: 600; font-family: 'Poppins', sans-serif; color: var(--heading-color); text-align: right; }
        .cost-table .free-tier { color: var(--free-tier-color); font-weight: bold; }
        
        .calculator-layout { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 25px; align-items: flex-start; }
        .input-group { background: #fff; padding: 25px; border-radius: 15px; box-shadow: 0 8px 25px rgba(0,0,0,0.07); }
        .input-group h3 { display: flex; align-items: center; gap: 10px; font-family: 'Poppins', sans-serif; font-size: 1.3rem; margin-bottom: 20px; }
        #structure-group { border-left: 5px solid var(--primary-color); }
        #structure-group h3 { color: var(--primary-color); }
        #volume-group { border-left: 5px solid var(--accent-color); }
        #volume-group h3 { color: var(--accent-color); }
        #usage-group { border-left: 5px solid var(--secondary-color); }
        #usage-group h3 { color: var(--secondary-color); }

        .input-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .grid-span-2 { grid-column: 1 / -1; }
        .calc-input { display: flex; flex-direction: column; }
        .calc-input label, .calc-output label { font-size: 0.9rem; font-weight: 500; color: var(--secondary-color); margin-bottom: 5px; }
        .calc-input input { padding: 10px; border: 1px solid #e2e8f0; border-radius: 8px; font-family: 'Inter', sans-serif; font-size: 1rem; width: 100%; box-shadow: inset 0 2px 4px rgba(0,0,0,0.06); transition: border-color 0.3s ease, box-shadow 0.3s ease; }
        .calc-input input:focus { border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2); outline: none; }
        .calc-output { display: flex; flex-direction: column; }
        .calc-output span { background-color: #eef2ff; font-weight: 600; color: var(--heading-color); padding: 10px; border: 1px solid #dbeafe; border-radius: 8px; font-family: 'Inter', sans-serif; font-size: 1rem; width: 100%; text-align: right; }
        
        .input-with-unit { position: relative; }
        .input-with-unit::after { content: attr(data-unit); position: absolute; right: 12px; top: 50%; transform: translateY(-50%); color: #aaa; pointer-events: none; font-size: 0.9rem; }

        .number-input-stepper { position: relative; }
        .number-input-stepper .stepper-buttons { position: absolute; right: 4px; top: 4px; bottom: 4px; display: flex; flex-direction: column; }
        .number-input-stepper button { flex: 1; border: none; background: #f0f2f5; color: #555; cursor: pointer; width: 22px; font-size: 0.6rem; display: flex; align-items: center; justify-content: center; transition: background 0.2s ease; }
        .number-input-stepper button:hover { background: #e2e8f0; }
        .number-input-stepper button.stepper-up { border-radius: 4px 4px 0 0; border-bottom: 1px solid #fff; }
        .number-input-stepper button.stepper-down { border-radius: 0 0 4px 4px; }
        .number-input-stepper input { padding-right: 30px; text-align: right; }
        .input-with-unit .number-input-stepper input { padding-right: 80px; }

        .calculator-outputs { margin-top: 25px; padding: 20px; background-color: #f7f9fc; border-radius: 15px; border: 1px solid #e2e8f0; display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        .calculator-outputs h4 { grid-column: 1 / -1; font-family: 'Poppins', sans-serif; color: var(--heading-color); margin-bottom: -5px; border-bottom: 2px solid var(--primary-color); padding-bottom: 5px; display: inline-block; }

        #calculate-btn { margin-top: 20px; width: 100%; grid-column: 1 / -1; padding: 15px; border: none; border-radius: 8px; background: var(--primary-gradient); color: white; font-family: 'Poppins', sans-serif; font-size: 1.1rem; font-weight: 500; cursor: pointer; transition: all 0.3s ease; display: flex; justify-content: center; align-items: center; gap: 10px; }
        #calculate-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 20px var(--shadow-color); }
        #calculate-btn .spinner, #calculate-btn .check { display: none; }
        #calculate-btn.calculating .btn-text { display: none; }
        #calculate-btn.calculating .spinner { display: inline-block; width: 20px; height: 20px; border: 3px solid rgba(255,255,255,0.3); border-radius: 50%; border-top-color: #fff; animation: spin 1s ease-in-out infinite; }
        #calculate-btn.success { background: var(--accent-color); }
        #calculate-btn.success .btn-text { display: none; }
        #calculate-btn.success .check { display: inline-block; font-size: 1.5rem; }
        @keyframes spin { to { transform: rotate(360deg); } }

        .cost-table .main-row td { font-weight: bold; background-color: #f8fafc; color: var(--heading-color); }
        .cost-table .sub-row td { padding-left: 40px; color: var(--text-color); }
        .cost-table .sub-row td:first-child::before { content: "â†³"; margin-right: 10px; color: #9ca3af; }
        .cost-table .free-tier-credit { color: var(--free-tier-color); }
        .cost-table .net-cost-row td { border-top: 1px solid #e2e8f0; font-weight: bold; background-color: #f8fafc; }
        .cost-table .grand-total-row td { background: var(--secondary-color); color: white; font-size: 1.2rem; font-weight: bold; font-family: 'Poppins', sans-serif; }
        
        .summary-card { text-align: center; background: #fff; padding: 40px; border-radius: 15px; box-shadow: 0 10px 30px var(--shadow-color); }
        .summary-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; text-align: left; }
        .summary-item { display: flex; align-items: center; gap: 20px; padding: 25px; border-radius: 15px; background: #f7f9fc; border: 1px solid #eef2ff; }
        .summary-icon { flex-shrink: 0; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; border-radius: 50%; }
        .summary-icon svg { width: 28px; height: 28px; }
        .icon-onboarding { background-color: #e0e7ff; color: var(--primary-color); }
        .icon-monthly { background-color: #d1fae5; color: var(--accent-color); }
        .summary-text .label { font-size: 1rem; font-weight: 500; color: var(--secondary-color); }
        .summary-text .value { font-family: 'Poppins', sans-serif; font-size: 2.2rem; font-weight: 600; color: var(--heading-color); line-height: 1.2; }
        .total-summary { grid-column: 1 / -1; margin-top: 20px; padding: 25px; border-radius: 15px; background: var(--primary-gradient); color: white; text-align: center; }
        .total-summary .label { font-size: 1.2rem; opacity: 0.9; }
        .total-summary .value { font-family: 'Poppins', sans-serif; font-size: 3.2rem; font-weight: 700; color: white; }

        .continue-button {
            display: inline-block;
            margin-top: 40px;
            padding: 12px 24px;
            background: var(--primary-gradient);
            color: white;
            text-decoration: none;
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
            border-radius: 25px;
            box-shadow: 0 8px 15px var(--shadow-color);
            transition: all 0.3s ease;
        }
        .continue-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 20px rgba(102, 126, 234, 0.4);
        }

        /* --- RESPONSIVE DESIGN STYLES --- */
        @media (max-width: 1024px) {
            .slide-content-card { padding: 30px; }
            .nav-links { gap: 25px; }
        }

        @media (max-width: 768px) {
            body { height: auto; overflow-y: auto; -webkit-overflow-scrolling: touch; }
            .navbar { height: auto; padding: 10px 15px; flex-direction: column; }
            .nav-links { margin-top: 10px; flex-wrap: wrap; justify-content: center; gap: 10px 20px; }
            .nav-links a { font-size: 0.9rem; }
            .slides-container { margin-top: 110px; height: auto; perspective: none; }
            .slide { position: relative; height: auto; opacity: 1; transform: none; visibility: visible; display: block; padding: 15px; margin-bottom: 30px; }
            .slide:not(.active) { display: none; }
            .slide-content-card { padding: 20px; max-height: none; }
            .slide-indicator { display: none; }
            .calculator-layout, .summary-grid { grid-template-columns: 1fr; }
            .section-title { font-size: 1.7rem; }
            .summary-text .value { font-size: 2rem; }
            .total-summary .value { font-size: 2.5rem; }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <a href="index.html" class="nav-logo">ISC Digitalization Budget</a>
        <ul class="nav-links">
            <li><a href="index.html">1. Executive Summary</a></li>
            <li><a href="02_Trial_Project_SCM.html" class="active">2. Trial Project (SCM)</a></li>
            <li><a href="03_Company_Rollout.html">3. Company-Wide Rollout</a></li>
            <li><a href="04_AI_Tools_Budget.html">4. AI & Productivity Tools</a></li>
        </ul>
    </nav>

    <div class="slides-container">
        <div class="slide active">
            <div class="slide-content-card">
                <h2 class="section-title">Interactive Cost Assumptions</h2>
                <div class="calculator-layout">
                    <div class="input-group" id="structure-group">
                        <h3>ðŸ§¬ Data Structure</h3>
                        <div class="input-grid">
                            <div class="calc-input">
                                <label for="num-tables">No. of Tables</label>
                                <div class="input-with-unit" data-unit="Tables">
                                   <div class="number-input-stepper">
                                       <input type="text" id="num-tables" value="5" data-step="1" oninput="formatInput(this); updateInstantCalculations();">
                                       <div class="stepper-buttons"><button class="stepper-up">â–²</button><button class="stepper-down">â–¼</button></div>
                                   </div>
                                </div>
                            </div>
                            <div class="calc-input">
                                <label for="num-cols">Avg. Columns</label>
                                 <div class="input-with-unit" data-unit="Cols">
                                   <div class="number-input-stepper">
                                       <input type="text" id="num-cols" value="15" data-step="1" oninput="formatInput(this); updateInstantCalculations();">
                                       <div class="stepper-buttons"><button class="stepper-up">â–²</button><button class="stepper-down">â–¼</button></div>
                                   </div>
                                </div>
                            </div>
                        </div>
                    </div>
                     <div class="input-group" id="volume-group">
                        <h3>ðŸ“¦ Data Volume</h3>
                        <div class="input-grid">
                            <div class="calc-input grid-span-2">
                                <label>Avg. Initial Rows / Table</label>
                                <div class="input-with-unit" data-unit="Rows">
                                   <div class="number-input-stepper">
                                       <input type="text" id="avg-initial-rows" value="1,000" data-step="100" oninput="formatInput(this); updateInstantCalculations();">
                                       <div class="stepper-buttons"><button class="stepper-up">â–²</button><button class="stepper-down">â–¼</button></div>
                                   </div>
                                </div>
                            </div>
                             <div class="calc-input grid-span-2">
                                <label>Avg. New Rows / Table</label>
                                <div class="input-with-unit" data-unit="Rows">
                                   <div class="number-input-stepper">
                                       <input type="text" id="avg-monthly-growth-rows" value="200" data-step="50" oninput="formatInput(this); updateInstantCalculations();">
                                       <div class="stepper-buttons"><button class="stepper-up">â–²</button><button class="stepper-down">â–¼</button></div>
                                   </div>
                                </div>
                            </div>
                        </div>
                    </div>
                     <div class="input-group" id="usage-group">
                        <h3>ðŸ“ˆ Usage Pattern</h3>
                        <div class="input-grid">
                           <div class="calc-input grid-span-2">
                                <label>Monthly Data Scans</label>
                                <div class="input-with-unit" data-unit="Scans">
                                  <div class="number-input-stepper">
                                      <input type="text" id="query-multiplier" value="10" data-step="1" oninput="formatInput(this); updateInstantCalculations();">
                                      <div class="stepper-buttons"><button class="stepper-up">â–²</button><button class="stepper-down">â–¼</button></div>
                                  </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                 <div class="calculator-outputs">
                    <h4>Live Calculations</h4>
                    <div class="calc-output">
                        <label>Calculated Avg. Row Size</label>
                        <span id="row-size-kb">0.73 KB</span>
                    </div>
                    <div class="calc-output">
                        <label>Total Data Size (Month 1)</label>
                        <span id="total-data-size-gb">0.004 GB</span>
                    </div>
                    <div class="calc-output">
                        <label>Est. Monthly Data Scanned</label>
                        <span id="calculated-scanned-gb">0.04 GB</span>
                    </div>
                 </div>

                 <button id="calculate-btn">
                    <span class="btn-text">Calculate Costs & View Summary</span>
                    <span class="spinner"></span>
                    <span class="check">âœ”</span>
                 </button>
            </div>
        </div>

        <div class="slide">
             <div class="slide-content-card">
                <h2 class="section-title">ðŸš€ One-Time Onboarding Cost</h2>
                <table class="cost-table">
                    <thead><tr><th>Item</th><th>Description</th><th>Estimated Cost</th></tr></thead>
                    <tbody>
                        <tr>
                            <td><strong>BigQuery Data Ingestion</strong></td>
                            <td>Cost to load initial dataset: <br>
                                <strong id="onboarding-rows-display">5,000</strong> rows across 
                                <strong id="onboarding-tables-display">5</strong> tables, totalling 
                                <strong id="onboarding-size-display">~3.56 MB</strong>.
                            </td>
                            <td class="cost" id="onboarding-cost">$0.00</td>
                        </tr>
                        <tr style="background-color: #e6f7f2;">
                            <td colspan="3" style="padding: 20px; line-height: 1.8;">
                                <div style="text-align:center; font-weight:bold; color: var(--free-tier-color); font-size: 1.1rem; margin-bottom: 10px;">
                                    This cost is fully covered by the Google Cloud Free Tier.
                                </div>
                                <p style="text-align:center; max-width: 800px; margin: auto;">
                                    <strong>Loading data</strong> into BigQuery is <strong>free of charge</strong>. Costs are only incurred for data storage and data analysis (queries). The initial data size is well within the <strong>10 GB of free storage</strong> and any initial analysis would be covered by the <strong>1 TB of free queries</strong> that reset each month.
                                </p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="slide">
            <div class="slide-content-card">
                <h2 class="section-title">ðŸ’¡ Estimated Monthly Platform Cost</h2>
                <table class="cost-table">
                    <thead><tr><th>Item</th><th style="width: 35%;">Calculation</th><th>Cost</th></tr></thead>
                    <tbody>
                        <tr class="main-row">
                            <td colspan="3">Data Storage</td>
                        </tr>
                        <tr class="sub-row">
                            <td>Gross Storage Cost</td>
                            <td id="storage-gross-calc">(0.0043 GB * $0.02/GB)</td>
                            <td class="cost" id="storage-gross-cost">$0.00</td>
                        </tr>
                        <tr class="sub-row">
                            <td>Free Tier Credit (10 GB)</td>
                            <td id="storage-free-calc">(Up to 10 GB covered)</td>
                            <td class="cost free-tier-credit" id="storage-free-credit">-$0.00</td>
                        </tr>
                        <tr class="net-cost-row">
                            <td colspan="2">Net Storage Cost</td>
                            <td class="cost" id="storage-net-cost">$0.00</td>
                        </tr>

                        <tr class="main-row" style="border-top: 2px solid var(--primary-color);">
                            <td colspan="3">Data Analysis (Queries)</td>
                        </tr>
                        <tr class="sub-row">
                            <td>Gross Query Cost</td>
                            <td id="query-gross-calc">(0.00004 TB * $6.25/TB)</td>
                            <td class="cost" id="query-gross-cost">$0.00</td>
                        </tr>
                        <tr class="sub-row">
                            <td>Free Tier Credit (1 TB)</td>
                            <td id="query-free-calc">(Up to 1 TB covered)</td>
                            <td class="cost free-tier-credit" id="query-free-credit">-$0.00</td>
                        </tr>
                        <tr class="net-cost-row">
                            <td colspan="2">Net Analysis Cost</td>
                            <td class="cost" id="query-net-cost">$0.00</td>
                        </tr>

                        <tr class="grand-total-row">
                            <td colspan="2">Total Estimated Recurring Monthly Cost</td>
                            <td class="cost" id="total-monthly-cost">$0.00</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="slide">
            <div class="slide-content-card">
                <div class="summary-card">
                    <h2 class="section-title" style="color: var(--heading-color);">ðŸ“Š Financial Summary</h2>
                     <div class="summary-grid">
                        <div class="summary-item">
                            <div class="summary-icon icon-onboarding">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3" /></svg>
                            </div>
                            <div class="summary-text">
                                <div class="label">One-Time Onboarding Cost</div>
                                <div class="value" data-final-value="0" id="summary-onboarding-cost">$0.00</div>
                            </div>
                        </div>
                         <div class="summary-item">
                            <div class="summary-icon icon-monthly">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0h18M12 15.75h.008v.008H12v-.008z" /></svg>
                            </div>
                             <div class="summary-text">
                                <div class="label">Est. First Month's Platform Cost</div>
                                <div class="value" data-final-value="0" id="summary-monthly-cost">$0.00</div>
                            </div>
                        </div>
                        <div class="total-summary">
                            <div class="label">Total Initial Budget Request</div>
                            <div class="value" data-final-value="0" id="summary-total-cost">$0.00</div>
                        </div>
                    </div>
                    <a href="03_Company_Rollout.html" class="continue-button">Continue to Company-Wide Rollout &rarr;</a>
                </div>
            </div>
        </div>
    </div>
    
    <div class="slide-indicator"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- Guided Path Navigation Setup ---
            const pages = [
                'index.html',
                '02_Trial_Project_SCM.html',
                '03_Company_Rollout.html',
                '04_AI_Tools_Budget.html'
            ];
            const pathParts = window.location.pathname.split('/');
            const currentPageName = pathParts.pop() || 'index.html';
            const currentPageIndex = pages.findIndex(p => p.includes(currentPageName));

            // --- Slide Navigation ---
            const slides = document.querySelectorAll('.slide');
            const indicator = document.querySelector('.slide-indicator');
            const calculateBtn = document.getElementById('calculate-btn');
            let currentSlide = 0;
            let isNavigating = false;
            const navigationTimeout = 600;

            const parseFormattedNumber = (str) => parseFloat(String(str).replace(/,/g, '')) || 0;
            const formatWithCommas = (num, decimals = 0) => num.toLocaleString('en-US', {minimumFractionDigits: decimals, maximumFractionDigits: decimals});
            const formatCurrency = (num) => `$${num.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;

            function formatInput(inputElement) {
                const value = parseFormattedNumber(inputElement.value);
                inputElement.value = formatWithCommas(value);
            }
            window.formatInput = formatInput; 

            function updateInstantCalculations() {
                const numTables = parseFormattedNumber(document.getElementById('num-tables').value);
                const numCols = parseFormattedNumber(document.getElementById('num-cols').value);
                const avgInitialRows = parseFormattedNumber(document.getElementById('avg-initial-rows').value);
                const avgMonthlyGrowthRows = parseFormattedNumber(document.getElementById('avg-monthly-growth-rows').value);
                const queryMultiplier = parseFormattedNumber(document.getElementById('query-multiplier').value);
                const AVG_BYTES_PER_CELL = 50; 
                const calculatedRowSizeBytes = numCols * AVG_BYTES_PER_CELL;
                const calculatedRowSizeKB = calculatedRowSizeBytes / 1024;
                document.getElementById('row-size-kb').textContent = `${calculatedRowSizeKB.toFixed(2)} KB`;
                const initialRows = avgInitialRows * numTables;
                const monthlyGrowthRows = avgMonthlyGrowthRows * numTables;
                const initialStorageGB = (initialRows * calculatedRowSizeBytes) / (1024**3);
                const monthlyGrowthGB = (monthlyGrowthRows * calculatedRowSizeBytes) / (1024**3);
                const totalMonthlyStorageGB = initialStorageGB + monthlyGrowthGB;
                document.getElementById('total-data-size-gb').textContent = `${totalMonthlyStorageGB.toFixed(4)} GB`;
                const monthlyQueriesGB = totalMonthlyStorageGB * queryMultiplier;
                document.getElementById('calculated-scanned-gb').textContent = `${monthlyQueriesGB.toFixed(2)} GB`;
            }
            window.updateInstantCalculations = updateInstantCalculations;

            function calculateAll() {
                const numTables = parseFormattedNumber(document.getElementById('num-tables').value);
                const numCols = parseFormattedNumber(document.getElementById('num-cols').value);
                const avgInitialRows = parseFormattedNumber(document.getElementById('avg-initial-rows').value);
                const avgMonthlyGrowthRows = parseFormattedNumber(document.getElementById('avg-monthly-growth-rows').value);
                const queryMultiplier = parseFormattedNumber(document.getElementById('query-multiplier').value);
                const initialRows = avgInitialRows * numTables;
                const AVG_BYTES_PER_CELL = 50;
                const calculatedRowSizeBytes = numCols * AVG_BYTES_PER_CELL;
                const STORAGE_PRICE_PER_GB_MONTH = 0.02;
                const QUERY_PRICE_PER_TB = 6.25;
                const FREE_STORAGE_GB = 10;
                const FREE_QUERY_TB = 1;
                const initialStorageGB = (initialRows * calculatedRowSizeBytes) / (1024**3);
                const initialStorageMB = initialStorageGB * 1024;
                const monthlyGrowthGB = ((avgMonthlyGrowthRows * numTables) * calculatedRowSizeBytes) / (1024**3);
                const totalMonthlyStorageGB = initialStorageGB + monthlyGrowthGB;
                const monthlyQueriesGB = totalMonthlyStorageGB * queryMultiplier;
                const monthlyQueriesTB = monthlyQueriesGB / 1024;
                const grossStorageCost = totalMonthlyStorageGB * STORAGE_PRICE_PER_GB_MONTH;
                const storageFreeTierCredit = Math.min(totalMonthlyStorageGB, FREE_STORAGE_GB) * STORAGE_PRICE_PER_GB_MONTH;
                const netStorageCost = Math.max(0, grossStorageCost - storageFreeTierCredit);
                const grossQueryCost = monthlyQueriesTB * QUERY_PRICE_PER_TB;
                const queryFreeTierCredit = Math.min(monthlyQueriesTB, FREE_QUERY_TB) * QUERY_PRICE_PER_TB;
                const netQueryCost = Math.max(0, grossQueryCost - queryFreeTierCredit);
                const onboardingCost = 0;
                const totalMonthlyPlatformCost = netStorageCost + netQueryCost;

                document.getElementById('onboarding-rows-display').textContent = formatWithCommas(initialRows);
                document.getElementById('onboarding-tables-display').textContent = formatWithCommas(numTables);
                document.getElementById('onboarding-size-display').textContent = `~${initialStorageMB.toFixed(2)} MB`;
                document.getElementById('onboarding-cost').textContent = formatCurrency(onboardingCost);
                document.getElementById('storage-gross-calc').textContent = `(${totalMonthlyStorageGB.toFixed(4)} GB * ${formatCurrency(STORAGE_PRICE_PER_GB_MONTH)}/GB)`;
                document.getElementById('storage-gross-cost').textContent = formatCurrency(grossStorageCost);
                document.getElementById('storage-free-calc').textContent = `(${Math.min(totalMonthlyStorageGB, FREE_STORAGE_GB).toFixed(4)} of ${FREE_STORAGE_GB} GB free)`;
                document.getElementById('storage-free-credit').textContent = `-${formatCurrency(storageFreeTierCredit)}`;
                document.getElementById('storage-net-cost').textContent = formatCurrency(netStorageCost);
                document.getElementById('query-gross-calc').textContent = `(${monthlyQueriesTB.toFixed(5)} TB * ${formatCurrency(QUERY_PRICE_PER_TB)}/TB)`;
                document.getElementById('query-gross-cost').textContent = formatCurrency(grossQueryCost);
                document.getElementById('query-free-calc').textContent = `(${Math.min(monthlyQueriesTB, FREE_QUERY_TB).toFixed(5)} of ${FREE_QUERY_TB} TB free)`;
                document.getElementById('query-free-credit').textContent = `-${formatCurrency(queryFreeTierCredit)}`;
                document.getElementById('query-net-cost').textContent = formatCurrency(netQueryCost);
                document.getElementById('total-monthly-cost').textContent = formatCurrency(totalMonthlyPlatformCost);
                document.getElementById('summary-onboarding-cost').dataset.finalValue = onboardingCost;
                document.getElementById('summary-monthly-cost').dataset.finalValue = totalMonthlyPlatformCost;
                document.getElementById('summary-total-cost').dataset.finalValue = onboardingCost + totalMonthlyPlatformCost;
                localStorage.setItem('trial_monthly_cost', totalMonthlyPlatformCost);
            }

            function animateCountUp(el) {
                const endValue = parseFloat(el.dataset.finalValue);
                if (isNaN(endValue)) return;
                const duration = 1200;
                let startTimestamp = null;
                const step = (timestamp) => {
                    if (!startTimestamp) startTimestamp = timestamp;
                    const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                    el.textContent = formatCurrency(progress * endValue);
                    if (progress < 1) {
                        window.requestAnimationFrame(step);
                    }
                };
                window.requestAnimationFrame(step);
            }

            function showSlide(index) {
                slides.forEach(slide => slide.classList.remove('active'));
                slides[index].classList.add('active');
                indicator.textContent = `${index + 1} / ${slides.length}`;
                if (index === 3) {
                    animateCountUp(document.getElementById('summary-onboarding-cost'));
                    animateCountUp(document.getElementById('summary-monthly-cost'));
                    animateCountUp(document.getElementById('summary-total-cost'));
                }
            }

            function nextSlide() {
                if (currentSlide < slides.length - 1) {
                    currentSlide++;
                    showSlide(currentSlide);
                } else {
                    if (currentPageIndex < pages.length - 1) {
                        window.location.href = pages[currentPageIndex + 1];
                    }
                }
            }

            function prevSlide() {
                if (currentSlide > 0) {
                    currentSlide--;
                    showSlide(currentSlide);
                } else {
                    if (currentPageIndex > 0) {
                        window.location.href = pages[currentPageIndex - 1];
                    }
                }
            }

            calculateBtn.addEventListener('click', () => {
                if (calculateBtn.classList.contains('calculating')) return;
                calculateBtn.classList.add('calculating');
                setTimeout(() => {
                    calculateAll();
                    calculateBtn.classList.remove('calculating');
                    calculateBtn.classList.add('success');
                    setTimeout(() => {
                        nextSlide();
                        setTimeout(() => { calculateBtn.classList.remove('success'); }, 500);
                    }, 800);
                }, 500);
            });

            document.addEventListener('keydown', (e) => {
                if (document.activeElement.tagName === 'INPUT' && (e.key === 'ArrowLeft' || e.key === 'ArrowRight')) return;
                if (isNavigating) return;
                isNavigating = true;
                if (e.key === 'ArrowRight' || e.key === 'ArrowDown') nextSlide();
                else if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') prevSlide();
                setTimeout(() => { isNavigating = false; }, navigationTimeout);
            });
            
            document.addEventListener('wheel', (e) => {
                const card = e.target.closest('.slide-content-card');
                if (card && card.scrollHeight > card.clientHeight) return;
                if (isNavigating) return;
                isNavigating = true;
                if (e.deltaY > 0) nextSlide();
                else prevSlide();
                setTimeout(() => { isNavigating = false; }, navigationTimeout);
            }, { passive: false });
            
            document.querySelector('.slide-content-card').addEventListener('click', function(e) {
                const upButton = e.target.closest('.stepper-up');
                const downButton = e.target.closest('.stepper-down');
                if (!upButton && !downButton) return;
                const stepper = e.target.closest('.number-input-stepper');
                const input = stepper.querySelector('input');
                const step = parseFloat(input.dataset.step) || 1;
                let value = parseFormattedNumber(input.value);
                if (upButton) value += step;
                else if (downButton) value -= step;
                input.value = Math.max(0, value);
                formatInput(input);
                updateInstantCalculations();
            });
            
            showSlide(currentSlide);
            updateInstantCalculations();
            calculateAll();
        });
    </script>
</body>
</html>
